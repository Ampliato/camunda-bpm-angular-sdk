"use strict";angular.module("camBpmSdk",[]).value("HttpClient",CamSDK.Client).value("CamForm",CamSDK.Form).value("MockHttpClient",CamSDKMocks).factory("camApiHttpClient",["MockHttpClient","$rootScope",function(e,t){function i(t){var i=t.mock===!0?e:CamSDK.Client.HttpClient;this._wrapped=new i(t)}return angular.forEach(["post","get","load","put","del"],function(e){i.prototype[e]=function(i,n){if(n.done){var o=n.done;n.done=function(e,i){t.$apply(function(){o(e,i)})},this._wrapped[e](i,n)}}}),angular.forEach(["on","once","off","trigger"],function(e){i.prototype[e]=function(){this._wrapped[e].apply(this,arguments)}}),i}]).provider("camApi",function(){var e={apiUri:"engine-rest/engine"};this.setApiConfiguration=function(t){e=t},this.$get=["camApiHttpClient",function(t){var i=angular.copy(e);return i.HttpClient=t,new CamSDK.Client(i)}]}),angular.module("camForm",["camBpmSdk"]).directive("camForm",function(){return{restrict:"EA",scope:{processDefinition:"=",task:"="},controller:["$scope","$element","$compile","camApi",function(e,t,i,n){function o(){var t,i=(e.formKey||"").split("embedded:"),o=e.formContextPath||"";if(i.length>1?(t=i.pop(),o+="/"!==o.slice(-1)?"/":"",t=t.replace(/app:(\/?)/,o)):t=e.formKey,!t)throw"ErRor";n.http.load(t,{done:function(e,t){if(e)throw e;r(t)}})}function r(t){c.html("<div>"+t+"</div>"),i(angular.element(c.children()[0]).contents())(e)}function a(){n.resource("process-definition").startForm({id:e.processDefinition.id},function(t,i){if(t)throw t;i.key&&(e.formKey=i.key,e.formContextPath=i.contextPath,o())})}var c=angular.element(t.children()[0]);e.formVariables={},this.setFormVariable=function(t,i,n){e.formVariables[t]={value:i,type:n}},this.getFormVariable=function(t){return e.formVariables[t]},e.submitForm=function(t){var i,o={};e.processDefinition?(o.id=e.processDefinition.id,i="process-definition"):(o.id=e.task.id,i="task"),o.variables=e.formVariables,n.resource(i).submitForm(o,function(e,i){if(e){if(!t)throw e;t(e,i)}t&&t(e,i)})},e.$watch("processDefinition",function(){e.processDefinition&&a()}),e.$watch("task",function(){e.taskId&&a()})}],link:function(){},templateUrl:"directives/camForm/camForm.html"}}).directive("camVariableName",function(){return{restrict:"A",scope:{variableName:"@camVariableName",variableType:"@camVariableType",model:"=ngModel"},require:["ngModel","^camForm"],controller:function(){},link:function(e,t,i,n){var o=n[0],r=n[1];e.$watch(function(){return o.$modelValue},function(){r.setFormVariable(e.variableName,o.$modelValue,e.variableType)})}}}),angular.module("camBpmSdk").run(["$templateCache",function(e){e.put("directives/camForm/camForm.html",'<div ng-form="variablesForm" class="cam-form-container"></div>\n')}]);